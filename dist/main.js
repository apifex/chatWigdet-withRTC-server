(()=>{const e=document.getElementById("loginform");e.addEventListener("submit",(t=>{"admin"===e.elements.login.value&&"password"===e.elements.password.value&&(document.getElementById("main").style.display="grid",document.getElementById("login-wrapper").style.display="none",a()),t.preventDefault()}));const t=document.getElementById("status"),n=document.getElementById("settings");n.addEventListener("submit",(e=>{let s={telegram_id:n.elements.telegram_id.value,token_1:n.elements.token1.value,token_2:n.elements.token2.value,token_3:n.elements.token3.value,token_4:n.elements.token4.value,token_5:n.elements.token5.value,telegramUsername:n.elements.telegram_username.value,whatsapp1:n.elements.whatsapp1.value};fetch("https://widgettelegram-server.azurewebsites.net/settings",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(s)}).then((e=>"200"===e.status?t.innerHTML("Zapisano w bazie danych"):t.innerHTML("Wystąpił błąd! Spróbuj ponownie!"))),e.preventDefault()}));let s=[];const a=async()=>{const e=await fetch("https://widgettelegram-server.azurewebsites.net/getchats",{headers:{"Content-Type":"application/json"},method:"POST"});s=await e.json(),i(s)},l=document.getElementById("chatsList"),i=e=>{for(let t=0;t<e.length;t++){let n=document.createElement("li");n.classList.add("listHistory"),n.innerHTML=e[t].chatID,n.addEventListener("click",(()=>m(t))),l.appendChild(n)}},d=document.getElementById("chatTitle"),o=document.getElementById("chat"),m=e=>{o.innerHTML="",d.innerHTML=s[e].chatID,s[e].conversation.forEach((e=>{const t=document.createElement("div");e.isUser?(t.classList.add("message"),t.classList.add("message-personal"),t.innerHTML=e.msg):(t.classList.add("message"),t.innerHTML=e.msg),o.appendChild(t)}))}})();